(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7522],{3377:(e,t,a)=>{"use strict";a.d(t,{c:()=>s});let s={name:"PAS Trading CO",address:"456 Tech Park Road, Bangalore, KA 560001, India",logoUrl:"",logoHint:"company text logo",contact:"Phone: +91 98765 43210 | Email: sales@stockpilot.co.in",storeType:"Electronics & Gadgets Retail",gstNo:"29ABCDE1234F1Z5"}},27045:(e,t,a)=>{"use strict";a.d(t,{default:()=>i});var s=a(95155),r=a(68856);function i(){return(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)(r.E,{className:"h-10 w-1/2"}),(0,s.jsx)(r.E,{className:"h-8 w-1/3"}),(0,s.jsx)(r.E,{className:"h-24 w-full"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,s.jsx)(r.E,{className:"h-40 w-full"}),(0,s.jsx)(r.E,{className:"h-60 w-full"})]}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsx)(r.E,{className:"h-48 w-full"})})]})]})}},34301:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},35179:(e,t,a)=>{"use strict";a.d(t,{default:()=>q});var s=a(95155),r=a(12115),i=a(35695),l=a(62523),n=a(30285),o=a(40157);let c=(0,o.A)("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);var d=a(66695);let m=e=>{let{onProductAdd:t}=e,[a,i]=(0,r.useState)("");return(0,s.jsxs)(d.Zp,{className:"shadow-md",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(d.ZB,{className:"text-lg sm:text-xl text-primary",children:"Add Product to Bill"}),(0,s.jsx)(d.BT,{className:"text-sm sm:text-base",children:"Enter barcode or serial number to add a product."})]}),(0,s.jsxs)(d.Wu,{children:[(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a.trim()&&(t(a.trim()),i(""))},className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[(0,s.jsx)(l.p,{type:"text",value:a,onChange:e=>i(e.target.value),placeholder:"Enter Barcode or Serial Number","aria-label":"Barcode or Serial Number",className:"flex-grow text-sm sm:text-base"}),(0,s.jsxs)(n.$,{type:"submit",className:"w-full sm:w-auto bg-accent hover:bg-accent/90 text-accent-foreground",children:[(0,s.jsx)(c,{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5"})," Add Item"]})]}),(0,s.jsx)("p",{className:"mt-2 text-xs sm:text-sm text-muted-foreground",children:"Note: This is a mockup. Actual camera scanning is not implemented."})]})]})};var u=a(85127),x=a(87374);let h=(0,o.A)("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);var p=a(34301),g=a(77223),b=a(66766),f=a(66424);let y=e=>{let{items:t,onRemoveItem:a,onUpdateQuantity:r}=e,i=(e,t,a)=>{r(e,Math.max(1,t+a))};return(0,s.jsxs)(d.Zp,{className:"shadow-md",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(d.ZB,{className:"text-lg sm:text-xl text-primary",children:"Current Bill Items"}),(0,s.jsx)(d.BT,{className:"text-sm sm:text-base",children:"Review items added to the bill before finalizing."})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsxs)(f.F,{className:"w-full whitespace-nowrap rounded-md border",children:[(0,s.jsxs)(u.XI,{className:"min-w-[600px] sm:min-w-full",children:[(0,s.jsx)(u.A0,{children:(0,s.jsxs)(u.Hj,{children:[(0,s.jsx)(u.nd,{className:"w-[50px] sm:w-[60px] px-2 sm:px-4",children:"Image"}),(0,s.jsx)(u.nd,{className:"px-2 sm:px-4",children:"Product"}),(0,s.jsx)(u.nd,{className:"text-right px-2 sm:px-4",children:"Price"}),(0,s.jsx)(u.nd,{className:"text-center w-[120px] sm:w-[150px] px-1 sm:px-4",children:"Quantity"}),(0,s.jsx)(u.nd,{className:"text-right px-2 sm:px-4",children:"Subtotal"}),(0,s.jsx)(u.nd,{className:"text-center w-[60px] sm:w-[80px] px-2 sm:px-4",children:"Remove"})]})}),(0,s.jsx)(u.BF,{children:0===t.length?(0,s.jsx)(u.Hj,{children:(0,s.jsx)(u.nA,{colSpan:6,className:"h-24 text-center text-sm sm:text-base",children:"No items added to the bill yet."})}):t.map(e=>(0,s.jsxs)(u.Hj,{children:[(0,s.jsx)(u.nA,{className:"px-2 sm:px-4",children:e.imageUrl?(0,s.jsx)(b.default,{src:e.imageUrl,alt:e.name,width:32,height:32,className:"rounded-md object-cover sm:w-10 sm:h-10","data-ai-hint":e.imageHint||"product item"}):(0,s.jsx)("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-secondary rounded-md flex items-center justify-center text-muted-foreground",children:(0,s.jsx)(x.A,{className:"h-5 w-5 sm:h-6 sm:w-6"})})}),(0,s.jsx)(u.nA,{className:"font-medium text-xs sm:text-sm px-2 sm:px-4 whitespace-normal break-words max-w-[150px] sm:max-w-xs",children:e.name}),(0,s.jsxs)(u.nA,{className:"text-right text-xs sm:text-sm px-2 sm:px-4",children:["₹",e.price.toFixed(2)]}),(0,s.jsx)(u.nA,{className:"text-center px-1 sm:px-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-center space-x-1 sm:space-x-2",children:[(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-7 w-7 sm:h-8 sm:w-8",onClick:()=>i(e.id,e.billQuantity,-1),disabled:e.billQuantity<=1,children:(0,s.jsx)(h,{className:"h-4 w-4 sm:h-5 sm:w-5"})}),(0,s.jsx)(l.p,{type:"number",value:e.billQuantity,onChange:t=>r(e.id,Math.max(1,parseInt(t.target.value)||1)),className:"w-12 sm:w-16 text-center h-7 sm:h-9 text-xs sm:text-sm",min:"1"}),(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-7 w-7 sm:h-8 sm:w-8",onClick:()=>i(e.id,e.billQuantity,1),children:(0,s.jsx)(p.A,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]})}),(0,s.jsxs)(u.nA,{className:"text-right text-xs sm:text-sm px-2 sm:px-4",children:["₹",(e.price*e.billQuantity).toFixed(2)]}),(0,s.jsx)(u.nA,{className:"text-center px-2 sm:px-4",children:(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-7 w-7 sm:h-8 sm:w-8",onClick:()=>a(e.id),title:"Remove Item",children:(0,s.jsx)(g.A,{className:"h-3 w-3 sm:h-4 sm:w-4 text-red-600"})})})]},e.id))})]}),(0,s.jsx)(f.$,{orientation:"horizontal"})]})})]})};var N=a(63655),v="horizontal",j=["horizontal","vertical"],w=r.forwardRef((e,t)=>{var a;let{decorative:r,orientation:i=v,...l}=e,n=(a=i,j.includes(a))?i:v;return(0,s.jsx)(N.sG.div,{"data-orientation":n,...r?{role:"none"}:{"aria-orientation":"vertical"===n?n:void 0,role:"separator"},...l,ref:t})});w.displayName="Separator";var k=a(59434);let S=r.forwardRef((e,t)=>{let{className:a,orientation:r="horizontal",decorative:i=!0,...l}=e;return(0,s.jsx)(w,{ref:t,decorative:i,orientation:r,className:(0,k.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),...l})});S.displayName=w.displayName;let F=(0,o.A)("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),A=(0,o.A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var z=a(50172);let M=e=>{let{items:t,onFinalizeBill:a,finalizeButtonText:r="Finalize & Generate Bill",isProcessing:i,disabled:l}=e,o=t.reduce((e,t)=>e+t.price*t.billQuantity,0),c=.18*o,m=o+c,u=r.toLowerCase().includes("update")?F:A;return(0,s.jsxs)(d.Zp,{className:"shadow-lg lg:sticky lg:top-20",children:[(0,s.jsxs)(d.aR,{children:[(0,s.jsx)(d.ZB,{className:"text-lg sm:text-xl text-primary",children:"Bill Summary"}),(0,s.jsx)(d.BT,{className:"text-sm sm:text-base",children:"Review the total amount before finalizing."})]}),(0,s.jsxs)(d.Wu,{className:"space-y-2 sm:space-y-3 text-sm sm:text-base",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Subtotal:"}),(0,s.jsxs)("span",{className:"font-medium",children:["₹",o.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("span",{className:"text-muted-foreground",children:["GST (","18","%):"]}),(0,s.jsxs)("span",{className:"font-medium",children:["₹",c.toFixed(2)]})]}),(0,s.jsx)(S,{}),(0,s.jsxs)("div",{className:"flex justify-between text-md sm:text-lg font-semibold",children:[(0,s.jsx)("span",{className:"text-foreground",children:"Total Amount:"}),(0,s.jsxs)("span",{className:"text-primary",children:["₹",m.toFixed(2)]})]})]}),(0,s.jsx)(d.wL,{children:(0,s.jsxs)(n.$,{onClick:a,className:"w-full bg-primary hover:bg-primary/90",disabled:l||0===t.length||i,size:"lg",children:[i?(0,s.jsx)(z.A,{className:"mr-2 h-5 w-5 animate-spin"}):(0,s.jsx)(u,{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5"}),i?r.toLowerCase().includes("update")?"Updating...":"Finalizing...":r]})})]})},C="WALK_IN_CUSTOMER";var E=a(86442),T=a(87481),P=a(55365);let I=(0,o.A)("UserSearch",[["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}],["path",{d:"M10.3 15H7a4 4 0 0 0-4 4v2",key:"3bnktk"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["path",{d:"m21 21-1.9-1.9",key:"1g2n9r"}]]),B=(0,o.A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var H=a(80410),D=a(3377),Q=a(68856),R=a(27045),L=a(49150);function q(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)(),a=t.get("fromOrder"),o=t.get("intent"),[c,u]=(0,r.useState)([]),[x,h]=(0,r.useState)([]),[g,b]=(0,r.useState)(!0),[f,N]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null),[w,k]=(0,r.useState)(""),[S,F]=(0,r.useState)(null),[A,z]=(0,r.useState)([]),[q,O]=(0,r.useState)(!1),[U,$]=(0,r.useState)(!1),{toast:W}=(0,T.dj)(),Z="edit"===o?"Edit Order":a?"Re-create Bill":"Create New Bill",_=(0,r.useCallback)(async()=>{b(!0);try{let e=await (0,H.d$)();h(e)}catch(e){console.error("Error fetching products:",e),W({title:"Error",description:"Failed to load products.",variant:"destructive"})}b(!1)},[W]);(0,r.useEffect)(()=>{_()},[_]),(0,r.useEffect)(()=>{a&&x.length>0&&(async()=>{N(!0);try{let t=await (0,H.r$)(a);if(t){let e=t.items.map(e=>{var t,a;let s=x.find(t=>t.id===e.productId);return{...e,id:e.productId,name:(null==s?void 0:s.name)||e.name,price:(null==s?void 0:s.price)||e.price,quantity:null!=(t=null==s?void 0:s.quantity)?t:0,billQuantity:e.billQuantity,categoryId:null!=(a=null==s?void 0:s.categoryId)?a:"",serialNumber:e.serialNumber||(null==s?void 0:s.serialNumber)||"",barcode:e.barcode||(null==s?void 0:s.barcode)||"",imageUrl:(null==s?void 0:s.imageUrl)||e.imageUrl||"",imageHint:(null==s?void 0:s.imageHint)||e.imageHint||""}});if(u(e),t.customerId&&t.customerId!==C){let e=await (0,H.xt)(t.customerId);j(e),e&&k(e.mobileNumber)}else t.customerMobile&&t.customerId===C&&k(t.customerMobile);let a="edit"===o?"Order ".concat(t.orderNumber," loaded for editing."):"Items from order ".concat(t.orderNumber," loaded for re-billing.");W({title:"Order Loaded",description:a})}else W({title:"Error",description:"Order not found for re-billing/editing.",variant:"destructive"}),e.replace("/billing")}catch(t){console.error("Error loading order for re-bill/edit:",t),W({title:"Error",description:"Failed to load order for re-billing/editing.",variant:"destructive"}),e.replace("/billing")}N(!1)})()},[a,W,x,e,o]);let G=e=>{u(c.filter(t=>t.id!==e))},V=async e=>{let t=e||w.trim();if(!t){z([]),F(null),j(null);return}O(!0),F(null);try{let e=await (0,H.bD)(t);z(e),0===e.length?(W({title:"No Customer Found",description:"No customer with this mobile. You can add them."}),F(t),j(null)):1===e.length&&X(e[0])}catch(e){W({title:"Search Error",description:"Failed to search for customer.",variant:"destructive"})}O(!1)},X=e=>{j(e),z([]),k(e.mobileNumber),F(null)},K=()=>{j(null),k(""),z([]),F(null)},Y=async e=>{try{if((await (0,H.bD)(e.mobileNumber)).length>0)return void W({title:"Mobile Number Exists",description:"This mobile number is already associated with another customer.",variant:"destructive"});let t={...e,imageUrl:"https://picsum.photos/seed/".concat(encodeURIComponent(e.name.split(" ")[0]),"/200/200"),imageHint:"person avatar"},a=await (0,H.yw)(t),s={...t,id:a};X(s),$(!1),F(null),W({title:"Customer Added",description:'"'.concat(e.name,'" has been successfully added and selected for this bill.')})}catch(e){console.error("Error adding customer from billing:",e),W({title:"Error",description:"Failed to add new customer.",variant:"destructive"})}},J=async()=>{if(0===c.length)return void W({title:"Empty Bill",description:"Cannot generate an empty bill. Add items first.",variant:"destructive"});if(!v&&!S)return void W({title:"Customer Not Selected",description:"Please search for a customer or add a new one before finalizing the bill.",variant:"destructive"});let t=c.reduce((e,t)=>e+t.price*t.billQuantity,0),s=.18*t,r=c.map(e=>({productId:e.id,name:e.name,price:e.price,billQuantity:e.billQuantity,imageUrl:e.imageUrl||null,imageHint:e.imageHint||null,serialNumber:e.serialNumber||null,barcode:e.barcode||null})),i=(null==v?void 0:v.id)||C,l=(null==v?void 0:v.name)||"Walk-in Customer",n=(null==v?void 0:v.mobileNumber)||S||"N/A",o=(null==v?void 0:v.address)||null,d=c.map(e=>({productId:e.id,quantity:e.billQuantity}));try{let c=await (0,H.uq)({customerId:i,customerName:l,customerMobile:n,customerAddress:o,items:r,subtotal:t,taxAmount:s,totalAmount:t+s},d),m=await (0,H.r$)(c);if(!m)throw Error("Failed to retrieve the newly created order for PDF generation.");(0,L.f)(m,D.c),W({title:"Bill Sent for Printing!",description:"Order ".concat(m.orderNumber," saved. PDF is opening for print."),className:"bg-green-500 text-white",duration:5e3}),u([]),K(),_(),a&&e.replace("/billing")}catch(e){console.error("Error finalizing bill:",e),W({title:"Bill Finalization Failed",description:"Could not save order or generate PDF. Please try again.",variant:"destructive"})}};return g&&!a||a&&f?(0,s.jsx)(R.default,{}):(0,s.jsxs)("div",{className:"space-y-6 md:space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight text-primary",children:Z}),(0,s.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground",children:"edit"===o?"Modify the items and customer details for this order and generate an updated bill.":"Add products by barcode/SN and generate a bill for your customer."})]}),(0,s.jsxs)(d.Zp,{className:"shadow-md",children:[(0,s.jsx)(d.aR,{children:(0,s.jsx)(d.ZB,{className:"text-lg sm:text-xl text-primary",children:"Customer Details"})}),(0,s.jsx)(d.Wu,{className:"space-y-3",children:v?(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-3 border rounded-md bg-secondary/50",children:[(0,s.jsxs)("div",{className:"mb-2 sm:mb-0",children:[(0,s.jsx)("p",{className:"font-semibold text-base sm:text-lg",children:v.name}),(0,s.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground",children:v.mobileNumber}),v.address&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground mt-1 max-w-xs truncate",title:v.address,children:v.address})]}),(0,s.jsx)(n.$,{variant:"outline",size:"sm",onClick:K,children:"Change"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2",children:[(0,s.jsx)(l.p,{type:"text",placeholder:"Search customer by mobile...",value:w,onChange:e=>{k(e.target.value),S&&F(null),A.length>0&&z([])},className:"flex-grow text-sm sm:text-base",onKeyDown:e=>"Enter"===e.key&&V(),"aria-label":"Search customer mobile number"}),(0,s.jsxs)(n.$,{onClick:()=>V(),disabled:q,className:"w-full sm:w-auto bg-accent hover:bg-accent/90 text-accent-foreground",children:[(0,s.jsx)(I,{className:"mr-2 h-4 w-4 sm:h-5 sm:w-5"})," ",q?"Searching...":"Search"]})]}),A.length>0&&(0,s.jsx)("ul",{className:"border rounded-md max-h-32 sm:max-h-40 overflow-y-auto text-sm sm:text-base",children:A.map(e=>(0,s.jsxs)("li",{className:"p-2 hover:bg-muted cursor-pointer border-b last:border-b-0",onClick:()=>X(e),children:[e.name," - ",e.mobileNumber,e.address&&(0,s.jsx)("span",{className:"text-xs block text-muted-foreground max-w-xs truncate",title:e.address,children:e.address})]},e.id))}),S&&0===A.length&&!q&&(0,s.jsxs)("div",{className:"mt-2 text-center p-2 border border-dashed rounded-md",children:[(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-muted-foreground mb-2",children:["Customer with mobile ",(0,s.jsx)("span",{className:"font-semibold",children:S})," not found."]}),(0,s.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>{$(!0)},children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4"})," Add New Customer"]})]}),!v&&!w&&!S&&(0,s.jsxs)(P.Fc,{variant:"default",className:"border-primary/50 text-primary bg-primary/5",children:[(0,s.jsx)(B,{className:"h-5 w-5 !text-primary"}),(0,s.jsx)(P.XL,{className:"font-semibold",children:"Tip"}),(0,s.jsx)(P.TN,{children:"Search for an existing customer by mobile number, or proceed to add a new customer if not found. For a quick walk-in sale, you can skip this step and finalize the bill directly."})]})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8 items-start",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,s.jsx)(m,{onProductAdd:e=>{let t=x.find(t=>t.barcode===e||t.serialNumber===e);if(!t)return void W({title:"Product Not Found",description:"No product found with barcode/SN: ".concat(e),variant:"destructive"});if(t.quantity<=0)return void W({title:"Out of Stock",description:'Product "'.concat(t.name,'" is currently out of stock.'),variant:"destructive"});let a=c.find(e=>e.id===t.id);a?a.billQuantity<t.quantity?u(c.map(e=>e.id===t.id?{...e,billQuantity:e.billQuantity+1}:e)):W({title:"Max Stock Reached",description:'Cannot add more of "'.concat(t.name,'". Max stock available: ').concat(t.quantity,"."),variant:"destructive"}):u([...c,{...t,billQuantity:1}])}}),0===c.length?g?(0,s.jsx)(Q.E,{className:"h-40 w-full"}):(0,s.jsxs)(P.Fc,{className:"border-accent text-accent",children:[(0,s.jsx)(P.XL,{children:"Empty Bill"}),(0,s.jsx)(P.TN,{children:"Scan or enter a product barcode/SN to start building the bill."})]}):(0,s.jsx)(y,{items:c,onRemoveItem:G,onUpdateQuantity:(e,t)=>{let a=x.find(t=>t.id===e);if(a){if(t<=0)return void G(e);if(t>a.quantity){W({title:"Stock Limit Exceeded",description:'Cannot set quantity for "'.concat(a.name,'" to ').concat(t,". Max stock available: ").concat(a.quantity,"."),variant:"destructive"}),u(c.map(t=>t.id===e?{...t,billQuantity:a.quantity}:t));return}u(c.map(a=>a.id===e?{...a,billQuantity:t}:a))}}})]}),(0,s.jsx)("div",{className:"lg:col-span-1 lg:sticky lg:top-20",children:g&&0===c.length?(0,s.jsx)(Q.E,{className:"h-48 w-full"}):(0,s.jsx)(M,{items:c,onFinalizeBill:J})})]}),(0,s.jsx)(E.A,{isOpen:U,onOpenChange:$,onSubmit:Y,initialMobileNumber:S||void 0})]})}},49150:(e,t,a)=>{"use strict";a.d(t,{f:()=>l});var s=a(26597),r=a(83013),i=a(35317);function l(e,t){let a=new s.Ay({orientation:"p",unit:"mm",format:"a4"}),l=a.internal.pageSize.getHeight(),n=a.internal.pageSize.getWidth(),o=n-20,c=10;a.setFontSize(18),a.setFont("helvetica","bold"),a.text(t.name,n/2,c,{align:"center"}),c+=7,a.setFontSize(9),a.setFont("helvetica","normal"),a.text(t.storeType,n/2,c,{align:"center"}),c+=8,a.setFontSize(8);let d=a.splitTextToSize(t.address,o/2-5);a.text(d,10,c);let m=a.splitTextToSize(t.contact,o/2-5);a.text(m,n-10,c,{align:"right"}),a.setFontSize(8);let u=a.getLineHeight(),x=d.length*u,h=m.length*u;if(c+=Math.max(x,h)+2,a.text("GSTIN: ".concat(t.gstNo),10,c),c+=5,a.setLineWidth(.3),a.line(10,c,n-10,c),c+=6,a.setFontSize(14),a.setFont("helvetica","bold"),a.text("INVOICE",n/2,c,{align:"center"}),c+=7,a.setFontSize(9),a.setFont("helvetica","normal"),a.text("Order No: ".concat(e.orderNumber),10,c),a.text("Date: ".concat(function(e){let t;if(!e)return"N/A";if(e instanceof i.Dc)try{t=e.toDate()}catch(t){return console.error("Error converting Firestore Timestamp to Date:",t,e),"Invalid Date"}else if(e instanceof Date)t=e;else{if("string"!=typeof e)return console.warn("Unknown date type in formatDateForPdf:",e),"N/A";t=new Date(e)}try{if(isNaN(t.getTime()))return console.warn("Invalid date created in formatDateForPdf:",e,"Resulted in:",t),"Invalid Date";return(0,r.GP)(t,"MMM dd, yyyy HH:mm:ss")}catch(e){return console.error("Error formatting date in formatDateForPdf:",e,t),"Error Date"}}(e.orderDate)),n-10,c,{align:"right"}),c+=5,a.text("Customer: ".concat(e.customerName||"N/A"),10,c),c+=5,a.text("Mobile: ".concat(e.customerMobile||"N/A"),10,c),c+=5,e.customerAddress){a.setFontSize(8);let t="Address: ".concat(e.customerAddress),s=a.splitTextToSize(t,o);a.text(s,10,c),a.setFontSize(8);let r=s.length*a.getLineHeight();c+=r+2,a.setFontSize(9)}else a.text("Address: N/A",10,c),c+=5;c+=2;let p=.3*o,g=.2*o,b=.08*o,f=.2*o,y=.22*o,N={productName:10,snBarcode:10+p,qty:10+p+g,price:10+p+g+b,subtotal:10+p+g+b+f},v=()=>{c+=1,a.setLineWidth(.1),a.line(10,c,n-10,c),c+=4,a.setFontSize(9),a.setFont("helvetica","bold"),a.text("Product Name",N.productName,c),a.text("SN/Barcode",N.snBarcode,c),a.text("Qty",N.qty+b/2,c,{align:"center"}),a.text("Price",N.price+f,c,{align:"right"}),a.text("Subtotal",N.subtotal+y,c,{align:"right"}),a.setFontSize(9),c+=a.getLineHeight(),c+=2,a.line(10,c,n-10,c),c+=3,a.setFont("helvetica","normal"),a.setFontSize(8)};v(),a.setFontSize(8),e.items.forEach(e=>{a.setFontSize(8);let t=a.getLineHeight(),s=a.splitTextToSize(e.name,p-2),r=e.serialNumber||e.barcode||"N/A",i=a.splitTextToSize(r,g-2),n=Math.max(s.length,i.length,1)*t+2;c+n>l-45&&(a.addPage(),c=10,v(),a.setFontSize(8));let o=c;a.text(s,N.productName+1,o),a.text(i,N.snBarcode+1,o),a.text(e.billQuantity.toString(),N.qty+b/2,o,{align:"center"}),a.text("₹".concat(e.price.toFixed(2)),N.price+f-1,o,{align:"right"}),a.text("₹".concat((e.price*e.billQuantity).toFixed(2)),N.subtotal+y-1,o,{align:"right"}),c+=n}),c+35>l-10&&(a.addPage(),c=10),c+=5;let j=10+.55*o,w=n-10-1;a.setLineWidth(.1),a.line(10,c,n-10,c),c+=5,a.setFontSize(9),a.setFont("helvetica","normal"),a.text("Subtotal:",j,c,{align:"left"}),a.text("₹".concat(e.subtotal.toFixed(2)),w,c,{align:"right"}),c+=5,a.text("GST (".concat("18","%):"),j,c,{align:"left"}),a.text("₹".concat(e.taxAmount.toFixed(2)),w,c,{align:"right"}),c+=5,a.setFontSize(10),a.setFont("helvetica","bold"),a.line(j-2,c,n-10,c),c+=5,a.text("Total Amount:",j,c,{align:"left"}),a.text("₹".concat(e.totalAmount.toFixed(2)),w,c,{align:"right"}),c+=10;let k=l-5-3;a.setFontSize(7),a.setFont("helvetica","italic");let S=a.internal.pages.length;for(let e=1;e<=S;e++)a.setPage(e),a.text("Page ".concat(e," of ").concat(S),10,k,{align:"left"}),a.text("Thank you for your business! - Generated by ".concat(t.name),n/2,k,{align:"center"});a.autoPrint({variant:"non-conform"}),a.output("dataurlnewwindow",{filename:"".concat(t.name.replace(/\s+/g,"_"),"-Bill-").concat(e.orderNumber,".pdf")})}},50172:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},51095:(e,t,a)=>{Promise.resolve().then(a.bind(a,51470)),Promise.resolve().then(a.bind(a,35179)),Promise.resolve().then(a.bind(a,27045))},55365:(e,t,a)=>{"use strict";a.d(t,{Fc:()=>o,TN:()=>d,XL:()=>c});var s=a(95155),r=a(12115),i=a(74466),l=a(59434);let n=(0,i.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=r.forwardRef((e,t)=>{let{className:a,variant:r,...i}=e;return(0,s.jsx)("div",{ref:t,role:"alert",className:(0,l.cn)(n({variant:r}),a),...i})});o.displayName="Alert";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("h5",{ref:t,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})});c.displayName="AlertTitle";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",a),...r})});d.displayName="AlertDescription"},77223:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(40157).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,9855,3930,9701,3013,5209,5589,7655,221,2882,6766,1327,8970,8469,5419,8441,1684,7358],()=>t(51095)),_N_E=e.O()}]);